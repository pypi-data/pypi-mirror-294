import numpy as np
from scipy import interpolate


def execute(json_inputs):

    ASSETS = [1, 
          1_000_000, 
          2_500_000,
          5_000_000, 
          10_000_000,
          15_000_000,
          20_000_000,
          25_000_000,
          50_000_000,
          75_000_000,
          100_000_000,
          250_000_000]

    BASE_RATES = [957,
                  1_635,
                  3_253,
                  3_565,
                  3_857,
                  4_409,
                  4_602,
                  4_943,
                  5_644,
                  6_262,
                  6_432,
                  7_533]
    
    LIM_RET = {
        0: -0.76,
        1_000: -0.6,
        2_500: -0.51,
        5_000: -0.406,
        7_500: -0.303,
        10_000: -0.231,
        15_000: -0.128,
        20_000: -0.064,
        25_000: 0,
        35_000: 0.105,
        50_000: 0.175,
        75_000: 0.277,
        100_000: 0.35,
        125_000: 0.406,
        150_000: 0.452,
        175_000: 0.491,
        200_000: 0.525,
        225_000: 0.555,
        250_000: 0.581,
        275_000: 0.605,
        300_000: 0.627,
        325_000: 0.648,
        350_000: 0.666,
        375_000: 0.684,
        400_000: 0.7,
        425_000: 0.715,
        450_000: 0.73,
        475_000: 0.743,
        500_000: 0.756,
        525_000: 0.807,
        550_000: 0.819,
        575_000: 0.831,
        600_000: 0.842,
        625_000: 0.853,
        650_000: 0.864,
        675_000: 0.874,
        700_000: 0.883,
        725_000: 0.893,
        750_000: 0.902,
        775_000: 0.91,
        800_000: 0.919,
        825_000: 0.927,
        850_000: 0.935,
        875_000: 0.943,
        900_000: 0.95,
        925_000: 0.957,
        950_000: 0.964,
        975_000: 0.971,
        1_000_000: 1,
        2_000_000: 1.415,
        2_500_000: 1.526,
        3_000_000: 1.637,
        4_000_000: 1.82,
        5_000_000: 1.986}
        
    
    INDUSTRY = {            
        'Hazard Group 1': 1,
        'Hazard Group 2': 1.4,
        'Hazard Group 3': 1.64}
    
    LCM = 1.7
    
    return int(
        np.interp(json_inputs['Asset Size'],
                  ASSETS, 
                  BASE_RATES)
        *(LIM_RET.get(json_inputs['Limit'])
          - LIM_RET.get(json_inputs['Retention']))
        * INDUSTRY.get(json_inputs['Industry'])
           * LCM)
