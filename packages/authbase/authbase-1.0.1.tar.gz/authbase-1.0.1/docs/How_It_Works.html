<!doctype html>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Simple, Open&#8209;Source, Email&#8209;Only Authentication for Your FastAPI Prototype, Proof of Concept, or MVP.">
<style>
    * { box-sizing: border-box; }
    body { font-family: sans-serif; }
    p, h1, ul, ol { margin: 0.5em 0; }
    a, a:visited { color: rgb(75, 141, 182); text-decoration: none; }
    input, button, textarea { display: block; padding: 1em; margin: 1em 0; }
    input, textarea { width: 100%; }
    a.button, button, input[type=button], input[type=submit], input[type=reset] {
        padding: 10px 20px;
        background-color: rgb(85, 151, 192);
        color: #fff;
        border: none;
        border-radius: 7px;
        cursor: pointer;
    }
    h1 { text-align: center; color: rgb(47, 84, 150); }
    table { border-collapse: collapse; width: 100%; }
    td, th { padding: 0.5em; border: 1px solid #ccc; }
    pre, code { background-color: #eee; }
    pre { line-height: 100%; padding: 1em; }
    #content { max-width: 42em; margin: 0 auto; }
</style>
<title>AuthBase</title>
<div id="content">
    <style>#header hr { margin-bottom: 1.5em; }</style>
<div id="header">
    <h1><a href="/">AuthBase</a></h1>
    <hr/>
</div>

    <style>h2 { text-align: center; }</style>
<h2>Overview</h2>
<p>AuthBase is good if you want to ship something quickly to test out a concept
and don't want to spend any time on an authentication system.</p>
<p>It is designed to provide boilerplate FastAPI code for a webapp.</p>
<p>It doesn't use passwords for authentication, instead it relies on users
clicking a link that was sent to their email address. The logic behind this is
that usually there is a reset password option that sends an email anyway, so in
theory it is a system that has the same or a similar level of security.</p>
<p>AuthBase also provides some basic utility functions for emailing the users, and
getting user information from the database.</p>
<h2>Features</h2>
<ul>
<li>Email confirmation upon user sign up to verify the user's email address.</li>
<li>Sign in link emailed to users upon sign in.</li>
<li>Plans for security fingerprint that displays browser, ip address, and where
possible, approximate location, of the person trying to log in.</li>
<li>Plans for an unsubscribe link at the bottom of all emails sent through the
gateway.</li>
</ul>
<h2>Setup</h2>
<pre><code>pip install authbase
</code></pre>
<p>Then in your FastAPI webapp:</p>
<pre><code>from fastapi import FastAPI
from authbase import install_auth_routes

app = FastAPI()
install_auth_routes(app)

# ... the rest of your code goes here ...
</code></pre>
<p>Then edit config.py in the root directory of your project to contain:</p>
<pre><code># Name of your webapp.
WEBAPP_NAME='My Example App'

# Email settings.
SMTP_HOST='smtp.example.org'
SMTP_PORT=587
SMTP_USERNAME='username'
SMTP_PASSWORDD='password'
SENDER_ADDRESS='My Example App &lt;no-reply@example.org&gt;'

# Redirct URL where users are sent after they successfully confirm their email
# address or sign up.
REDIRECT_URL='https://example.org/signed-in'
</code></pre>
<h2>API</h2>
<h3>POST /auth</h3>
<p>Signs up a new user or initiates the sign in process.</p>
<p>This endpoint takes a single parameter, <strong>email_address</strong>, which should be the
email address of the user signing up or signing in.</p>
<p>The response is HTML with a message instructing the user to check their email
for a confirmation link or a link to sign in.</p>
<p>This response sets a session_id cookie.</p>
<p>Here's an example JS snippet that you can attach to a form submit event:</p>
<pre><code>const form = document.getElementById("my-sign-in-form")
form.addEventListener("submit", event =&gt; {
    event.preventDefault();
    const formData = new FormData(event.currentTarget);
    fetch("https://api.example.org/auth", {
        method: "POST",
        body: formData,
        credentials: "include",
    }).then(... handle response ...);
});
</code></pre>
<h3>POST /sign_out</h3>
<p>This endpoint takes no parameters and signs out the user associated with the
session_id cookie.</p>
<p>Here's an example JS snippet that makes this request:</p>
<pre><code>await fetch('https://api.example.org/sign_out', {
    method: 'POST',
    credentials: 'include',
}); 
</code></pre>
<h3>GET /me</h3>
<p>Gets information about the currently signed in user.</p>
<p>The request should send the session_id cookie.</p>
<p>The response is A JSON object with two fields, <strong>id</strong>, and <strong>email_address</strong>.</p>
<p>This response returns error 401 UNAUTHENTICATED if the user has not signed in.</p>
<p>Here's an example JS snippet that makes this request:</p>
<pre><code>fetch('https://api.example.org/me', {
    method: 'GET',
    credentials: 'include',
}).then(... handle response ...);
</code></pre>
<h3>GET /sign_in/{session_secret}</h3>
<p>This endpoint is for internal use only.</p>

    
</div>
