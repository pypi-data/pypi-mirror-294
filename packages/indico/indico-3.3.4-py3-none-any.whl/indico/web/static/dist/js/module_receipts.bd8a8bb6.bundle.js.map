{"version":3,"file":"js/module_receipts.bd8a8bb6.bundle.js","mappings":"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","sources":["webpack:///indico/modules/receipts/client/js/printing/print.jsx","webpack:///indico/modules/receipts/client/js/printing/PrintReceiptsModal.jsx","webpack:///indico/web/client/js/utils/browser.js","webpack:///indico/modules/receipts/client/js/index.js"],"sourcesContent":["// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport printReceiptsURL from 'indico-url:receipts.generate_receipts';\n\nimport PropTypes from 'prop-types';\nimport React, {useState} from 'react';\nimport {Button, ButtonGroup, Icon, Label, Message, Modal, Table} from 'semantic-ui-react';\n\nimport {handleSubmitError} from 'indico/react/forms';\nimport {Translate} from 'indico/react/i18n';\nimport {injectModal} from 'indico/react/util';\nimport {indicoAxios} from 'indico/utils/axios';\nimport {camelizeKeys, snakifyKeys} from 'indico/utils/case';\n\n/**\n * This modal shows to the user any non-fatal templating errors which may have happened during\n * the templating process. The user may choose to download the result anyway (pre-downloaded by\n * the browser).\n */\nfunction PrintingErrorsModal({onRetry, onClose, errors}) {\n  const [open, setOpen] = useState(true);\n  return (\n    <Modal open={open} onClose={onClose} closeIcon>\n      <Modal.Header>\n        <Translate>Templating Errors</Translate>\n      </Modal.Header>\n      <Modal.Content>\n        <Message error>\n          <Translate>There were some errors while trying to generate your documents.</Translate>\n        </Message>\n        <Table celled fixed>\n          <Table.Header>\n            <Table.Row>\n              <Table.HeaderCell>\n                <Translate>Registrant's name</Translate>\n              </Table.HeaderCell>\n              <Table.HeaderCell>\n                <Translate>Missing fields</Translate>\n              </Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n          <Table.Body>\n            {errors.map(({registration, undefineds}) => (\n              <Table.Row key={registration.id}>\n                <Table.Cell>{registration.fullName}</Table.Cell>\n                <Table.Cell>\n                  {undefineds.map(name => (\n                    <Label key={`${registration.id}-${name}`} color=\"red\">\n                      {name}\n                    </Label>\n                  ))}\n                </Table.Cell>\n              </Table.Row>\n            ))}\n          </Table.Body>\n        </Table>\n      </Modal.Content>\n      <Modal.Actions>\n        <ButtonGroup>\n          <Button\n            onClick={async () => {\n              await onRetry();\n              setOpen(false);\n              onClose();\n            }}\n            primary\n          >\n            <Icon name=\"sync\" />\n            <Translate>Generate anyway</Translate>\n          </Button>\n          <Button\n            onClick={() => {\n              setOpen(false);\n              onClose();\n            }}\n          >\n            <Translate>Cancel</Translate>\n          </Button>\n        </ButtonGroup>\n      </Modal.Actions>\n    </Modal>\n  );\n}\n\nPrintingErrorsModal.propTypes = {\n  onRetry: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  errors: PropTypes.arrayOf(\n    PropTypes.shape({\n      registration: PropTypes.shape({\n        firstName: PropTypes.string,\n        lastName: PropTypes.string,\n      }),\n      undefineds: PropTypes.arrayOf(PropTypes.string),\n    })\n  ).isRequired,\n};\n\n/**\n * Handle the printing logic for a given template on a given event, based on previous user input.\n *\n * @param {number} eventId - Event ID\n * @param {Array.<String>} registrationIds - IDs of registrants to print\n * @param {Array.<Object>} values - custom field values to use in the template\n */\nexport async function printReceipt(eventId, registrationIds, values) {\n  const printReceiptsRequest = async (registrations, force) => {\n    const {template: templateId, ...data} = values;\n    data.registration_ids = registrations;\n    data.force = force;\n    const resp = await indicoAxios.post(printReceiptsURL(snakifyKeys({eventId, templateId})), data);\n    return resp.data;\n  };\n  try {\n    const data = await printReceiptsRequest(registrationIds, false);\n    let receiptIds = data.receipt_ids;\n    if (data.errors.length) {\n      await new Promise(resolve => {\n        injectModal(resolveModal => (\n          <PrintingErrorsModal\n            onRetry={async () => {\n              const retryData = await printReceiptsRequest(\n                [...new Set(data.errors.map(e => e.registration.id))],\n                true\n              );\n              receiptIds = [...receiptIds, ...retryData.receipt_ids];\n            }}\n            onClose={() => {\n              resolve();\n              resolveModal();\n            }}\n            errors={camelizeKeys(data.errors)}\n          />\n        ));\n      });\n    }\n    return {receiptIds, error: null};\n  } catch (error) {\n    return {receiptIds: null, error: handleSubmitError(error)};\n  }\n}\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport allTemplatesURL from 'indico-url:receipts.all_templates';\nimport eventImagesURL from 'indico-url:receipts.images';\nimport exportReceiptsURL from 'indico-url:receipts.receipts_export';\nimport previewReceiptsURL from 'indico-url:receipts.receipts_preview';\n\nimport PropTypes from 'prop-types';\nimport React, {useState} from 'react';\nimport {Field, FormSpy} from 'react-final-form';\nimport {Button, Dropdown, Form, Grid, Header, Icon, Message, Segment} from 'semantic-ui-react';\n\nimport {\n  formatters,\n  FinalCheckbox,\n  FinalDropdown,\n  FinalField,\n  FinalInput,\n  FinalSubmitButton,\n} from 'indico/react/forms';\nimport {FinalModalForm} from 'indico/react/forms/final-form';\nimport {useIndicoAxios} from 'indico/react/hooks';\nimport {Param, Plural, PluralTranslate, Singular, Translate} from 'indico/react/i18n';\nimport {handleAxiosError, indicoAxios} from 'indico/utils/axios';\nimport {downloadBlob} from 'indico/utils/browser';\nimport {snakifyKeys} from 'indico/utils/case';\n\nimport Previewer from '../templates/Previewer';\n\nimport {printReceipt} from './print';\nimport TemplateParameterEditor, {getDefaultFieldValue} from './TemplateParameterEditor';\n\nconst makeSubmitLabel = ({publish, notify_users: notifyUsers}, numRegistrants) => {\n  if (publish) {\n    return notifyUsers\n      ? PluralTranslate.string(\n          'Publish and send to registrant',\n          'Publish and send to registrants',\n          numRegistrants\n        )\n      : PluralTranslate.string(\n          'Save and publish to registration',\n          'Save and publish to registrations',\n          numRegistrants\n        );\n  }\n  return notifyUsers\n    ? PluralTranslate.string(\n        'Save and send to registrant',\n        'Save and send to registrants',\n        numRegistrants\n      )\n    : PluralTranslate.string('Save to registration', 'Save to registrations', numRegistrants);\n};\n\nconst downloadOptions = [\n  {\n    key: 'pdf',\n    value: 'pdf',\n    text: Translate.string('as a single PDF document'),\n  },\n  {\n    key: 'zip',\n    value: 'zip',\n    text: Translate.string('as a ZIP archive'),\n  },\n];\n\nconst archiveFilename = {\n  pdf: 'documents.pdf',\n  zip: 'documents.zip',\n};\n\n/**\n * This modal presents the user with a structured interface to download, e-mail or publish\n * receipts based on information from specific event registrations.\n */\nexport default function PrintReceiptsModal({onClose, registrationIds, eventId}) {\n  const [receiptIds, setReceiptIds] = useState([]);\n  const [downloading, setDownloading] = useState(false);\n\n  const {data: templateList, loading} = useIndicoAxios(allTemplatesURL({event_id: eventId}), {\n    trigger: eventId,\n    camelize: true,\n  });\n  const ready = !loading && !!templateList;\n\n  const makeUpdateTemplateFields = form => templateId => {\n    const {customFields, defaultFilename, title} = templateList.find(t => t.id === templateId);\n    form.change(\n      'custom_fields',\n      customFields\n        ? Object.assign({}, ...customFields.map(f => ({[f.name]: getDefaultFieldValue(f)})))\n        : {}\n    );\n    form.change('filename', defaultFilename || formatters.slugify(title));\n  };\n\n  const downloadReceipts = async format => {\n    setDownloading(true);\n    try {\n      const {data: downloadedData} = await indicoAxios.post(\n        exportReceiptsURL(snakifyKeys({eventId, format})),\n        snakifyKeys({receiptIds}),\n        {responseType: 'blob'}\n      );\n      downloadBlob(archiveFilename[format], downloadedData);\n    } catch (error) {\n      handleAxiosError(error);\n    }\n    setDownloading(false);\n  };\n\n  const getCustomFields = templateId =>\n    ready && templateList.find(tpl => tpl.id === templateId)?.customFields;\n\n  return (\n    <FinalModalForm\n      id=\"print-receipts\"\n      size=\"large\"\n      onSubmit={async values => {\n        const {receiptIds: printedReceiptIds, error} = await printReceipt(\n          eventId,\n          registrationIds,\n          values\n        );\n        if (error) {\n          return error;\n        } else if (printedReceiptIds.length > 0) {\n          setReceiptIds(printedReceiptIds);\n        }\n      }}\n      initialValues={{\n        custom_fields: {},\n        document_type: 'none',\n        filename: 'document',\n        save_config: true,\n      }}\n      onClose={() => onClose(receiptIds.length > 0)}\n      header={Translate.string('Generate Documents')}\n      keepDirtyOnReinitialize\n      noSubmitButton\n      disabledAfterSubmit\n    >\n      {fprops => (\n        <>\n          <Message color={receiptIds.length === 0 ? 'teal' : 'green'}>\n            <Icon name=\"print\" size=\"big\" />\n            {receiptIds.length === 0 ? (\n              <PluralTranslate count={registrationIds.length}>\n                <Singular>Generating document for a single registrant</Singular>\n                <Plural>\n                  Generating documents for{' '}\n                  <Param\n                    name=\"numberOfRegistrants\"\n                    value={registrationIds.length}\n                    wrapper={<strong />}\n                  />{' '}\n                  registrants\n                </Plural>\n              </PluralTranslate>\n            ) : (\n              <PluralTranslate count={receiptIds.length}>\n                <Singular>Successfully generated document for a single registrant</Singular>\n                <Plural>\n                  Successfully generated{' '}\n                  <Param name=\"numberOfReceipts\" value={receiptIds.length} wrapper={<strong />} />{' '}\n                  documents\n                </Plural>\n              </PluralTranslate>\n            )}\n          </Message>\n          <Grid columns={2} divided>\n            <Grid.Column>\n              <FinalDropdown\n                name=\"template\"\n                loading={!ready}\n                label={Translate.string('Document Template')}\n                placeholder={Translate.string('Select a document template')}\n                options={\n                  ready\n                    ? templateList.map(({id, title}) => ({key: id, text: title, value: id}))\n                    : []\n                }\n                onChange={makeUpdateTemplateFields(fprops.form)}\n                disabled={receiptIds.length > 0}\n                required\n                selection\n              />\n              <Field name=\"template\" subscription={{value: true}}>\n                {({input: {value: template}}) => (\n                  <FinalField\n                    name=\"custom_fields\"\n                    component={TemplateParameterEditor}\n                    customFields={template ? getCustomFields(template) : []}\n                    title={Translate.string('Template Parameters')}\n                    disabled={receiptIds.length > 0}\n                    fetchImagesURL={eventImagesURL({event_id: eventId})}\n                    defaultOpen\n                  />\n                )}\n              </Field>\n              <Field name=\"template\" subscription={{value: true}}>\n                {({input: {value: template}}) => (\n                  <FinalInput\n                    name=\"filename\"\n                    label={Translate.string('Filename')}\n                    type=\"text\"\n                    componentLabel=\"-{n}.pdf\"\n                    labelPosition=\"right\"\n                    disabled={!template || receiptIds.length > 0}\n                    format={v => formatters.slugify(v).replace(/\\.pdf$/, '')}\n                    formatOnBlur\n                    required\n                    fluid\n                  />\n                )}\n              </Field>\n              <FinalCheckbox\n                name=\"save_config\"\n                label={Translate.string('Remember settings')}\n                description={Translate.string(\n                  'Prefill template parameters (if present) and filename when generating more ' +\n                    'documents for the same template in this event.'\n                )}\n                disabled={receiptIds.length > 0}\n              />\n              <FinalCheckbox\n                name=\"publish\"\n                label={Translate.string('Publish document')}\n                description={PluralTranslate.string(\n                  'Make the resulting document available on the registration page.',\n                  'Make the resulting documents available on the registration pages.',\n                  registrationIds.length\n                )}\n                disabled={receiptIds.length > 0}\n              />\n              <Field name=\"publish\" subscription={{value: true}}>\n                {({input: {value: publish}}) => (\n                  <FinalCheckbox\n                    name=\"notify_users\"\n                    label={PluralTranslate.string(\n                      'Notify registrants via e-mail',\n                      'Notify registrants via e-mail',\n                      registrationIds.length\n                    )}\n                    description={\n                      publish\n                        ? PluralTranslate.string(\n                            'Send an e-mail to the registrant informing them that the document is available.',\n                            'Send an e-mail to the registrants informing them that the document is available.',\n                            registrationIds.length\n                          )\n                        : PluralTranslate.string(\n                            'Send an e-mail to the registrant with the document attached.',\n                            'Send an e-mail to the registrants with the document attached.',\n                            registrationIds.length\n                          )\n                    }\n                    disabled={receiptIds.length > 0}\n                  />\n                )}\n              </Field>\n              <Form.Group style={{alignItems: 'center'}}>\n                <FormSpy subscription={{values: true}}>\n                  {({values}) => (\n                    <FinalSubmitButton\n                      label={makeSubmitLabel(values, registrationIds.length)}\n                      icon={values.notify_users ? 'send' : 'save'}\n                      style={{width: '100%'}}\n                      disabledAfterSubmit\n                      fluid\n                    />\n                  )}\n                </FormSpy>\n                {receiptIds.length > 0 && (\n                  <>\n                    <Icon name=\"check\" color=\"green\" size=\"large\" />\n                    <Dropdown\n                      options={downloadOptions}\n                      scrolling\n                      icon={null}\n                      value={null}\n                      selectOnBlur={false}\n                      selectOnNavigation={false}\n                      onChange={(_, {value}) => downloadReceipts(value)}\n                      trigger={\n                        <Button\n                          icon\n                          style={{whiteSpace: 'nowrap', marginLeft: '1em'}}\n                          type=\"button\"\n                          loading={downloading}\n                        >\n                          <Icon name=\"download\" /> <Translate>Download</Translate>{' '}\n                          <Icon name=\"caret down\" />\n                        </Button>\n                      }\n                    />\n                  </>\n                )}\n              </Form.Group>\n            </Grid.Column>\n            <Grid.Column>\n              <Field name=\"template\" subscription={{value: true}}>\n                {({input: {value: templateId}}) => (\n                  <Field name=\"custom_fields\" subscription={{value: true}}>\n                    {({input: {value: customFields}}) =>\n                      templateId ? (\n                        <Previewer\n                          url={previewReceiptsURL(snakifyKeys({eventId, templateId}))}\n                          data={snakifyKeys({customFields, registrationIds})}\n                        />\n                      ) : (\n                        <Segment placeholder>\n                          <Header icon>\n                            <Icon name=\"eye\" />\n                            <Translate>Please select a template to preview it...</Translate>\n                          </Header>\n                        </Segment>\n                      )\n                    }\n                  </Field>\n                )}\n              </Field>\n            </Grid.Column>\n          </Grid>\n        </>\n      )}\n    </FinalModalForm>\n  );\n}\n\nPrintReceiptsModal.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  registrationIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n  eventId: PropTypes.number.isRequired,\n};\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n/**\n * Download data generated locally or retrieved through AJAX as a file.\n *\n * @param {String} fileName\n * @param {String} data - Raw data obtained from the server\n */\nexport function downloadBlob(fileName, data) {\n  const blob = new Blob([data]);\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  link.href = url;\n  link.download = fileName;\n  document.body.append(link);\n  link.click();\n  link.remove();\n  URL.revokeObjectURL(url);\n}\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2024 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport React from 'react';\n\nimport {injectModal} from 'indico/react/util';\n\nimport PrintReceiptsModal from './printing/PrintReceiptsModal';\n\nwindow.printReceipts = function({\n  registration_id: registrationIds,\n  event_id: eventId,\n  reload_after: reloadAfter,\n}) {\n  injectModal(resolve => (\n    <PrintReceiptsModal\n      onClose={generated => {\n        if (generated && reloadAfter) {\n          location.reload();\n        } else {\n          resolve();\n        }\n      }}\n      registrationIds={registrationIds}\n      eventId={eventId}\n    />\n  ));\n};\n"],"names":["printReceiptsURL","_buildFlaskURL","bind","endpoint","rules","args","converters","event_id","template_id","defaults","trace","data","isDynamic","PrintingErrorsModal","onRetry","onClose","errors","open","setOpen","useState","React","Modal","closeIcon","Header","Translate","Content","Message","error","Table","celled","fixed","Row","HeaderCell","Body","map","registration","undefineds","key","id","Cell","fullName","name","Label","color","Actions","ButtonGroup","Button","onClick","async","primary","Icon","propTypes","PropTypes","isRequired","firstName","lastName","allTemplatesURL","eventImagesURL","exportReceiptsURL","format","previewReceiptsURL","makeSubmitLabel","publish","notify_users","notifyUsers","numRegistrants","PluralTranslate","string","downloadOptions","value","text","archiveFilename","pdf","zip","PrintReceiptsModal","registrationIds","eventId","receiptIds","setReceiptIds","downloading","setDownloading","templateList","loading","useIndicoAxios","trigger","camelize","ready","downloadReceipts","downloadedData","indicoAxios","post","snakifyKeys","responseType","fileName","blob","Blob","link","document","createElement","url","URL","createObjectURL","href","download","body","append","click","remove","revokeObjectURL","downloadBlob","handleAxiosError","FinalModalForm","size","onSubmit","printedReceiptIds","values","printReceiptsRequest","registrations","force","template","templateId","registration_ids","receipt_ids","length","Promise","resolve","injectModal","resolveModal","retryData","Set","e","camelizeKeys","handleSubmitError","printReceipt","initialValues","custom_fields","document_type","filename","save_config","header","keepDirtyOnReinitialize","noSubmitButton","disabledAfterSubmit","fprops","count","Singular","Plural","Param","wrapper","Grid","columns","divided","Column","FinalDropdown","label","placeholder","options","title","onChange","form","customFields","defaultFilename","find","t","change","Object","assign","f","getDefaultFieldValue","formatters","slugify","disabled","required","selection","Field","subscription","input","FinalField","component","TemplateParameterEditor","tpl","fetchImagesURL","defaultOpen","FinalInput","type","componentLabel","labelPosition","v","replace","formatOnBlur","fluid","FinalCheckbox","description","Form","Group","style","alignItems","FormSpy","FinalSubmitButton","icon","width","Dropdown","scrolling","selectOnBlur","selectOnNavigation","_","whiteSpace","marginLeft","Previewer","Segment","window","printReceipts","registration_id","reload_after","reloadAfter","generated","location","reload"],"sourceRoot":""}