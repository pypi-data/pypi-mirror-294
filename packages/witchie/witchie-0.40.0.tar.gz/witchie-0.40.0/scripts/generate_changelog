#!/usr/bin/env python3

# SPDX-FileCopyrightText: 2017-2023 Ivan Habunek et al <ivan@habunek.com>
#
# SPDX-License-Identifier: GPL-3.0-only

"""
Generates a more user-readable changelog from changelog.yaml.
"""

import textwrap
import yaml

with open("changelog.yaml", "r") as f:
    data = yaml.safe_load(f)

print("Changelog")
print("---------")
print()
print("<!-- Do not edit. This file is automatically generated from changelog.yaml.-->")
print()

for version in data.keys():
    date = data[version]["date"]
    changes = data[version]["changes"]
    print(f"**{version} ({date})**")
    print()
    for c in changes:
        lines = textwrap.wrap(c, 78)
        initial = True
        for line in lines:
            if initial:
                print("* " + line)
                initial = False
            else:
                print("  " + line)
    print()
