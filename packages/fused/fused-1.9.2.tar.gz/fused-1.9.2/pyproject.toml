[tool.poetry]
name = "fused"
# Version is set to 0.0.0 as the version string is automatically generated by
# https://github.com/mtkennerly/poetry-dynamic-versioning
version = "1.9.2"
description = ""
authors = []
readme = "README.md"
packages = [{ include = "fused" }]

[project.urls]
Homepage = "https://www.fused.io"
Documentation = "https://docs.fused.io"
# Repository = "https://github.com/fusedlabs/fused-py"
# Issues = "https://github.com/fusedlabs/fused-py/issues"
Changelog = "https://docs.fused.io/python-sdk/changelog/"

[tool.versioning]
migration_version = "0.0.3"

[tool.poetry.dependencies]
python = ">=3.9,<=3.12"
shapely = "^2"
geopandas = "^0.14"
fsspec = "^2024.3.1"
# Note that if we want fused to load in pyodide, it may be required to convert pyarrow into an
# optional dependency.
pyarrow = ">=11"
pydantic = "^2.7.0"
requests = "^2.31"
affine = "^2"
pyproj = "^3.3"
click = "^8"
ipywidgets = "^8"
nest-asyncio = "^1.5"
importlib-resources = "^5.12.0"
aiohttp = "^3.8.3"

# Job dependencies
loguru = "^0.6.0"

# Xarray
# An older version is listed here to maintain Python 3.8 compatability
pandas = [
    {version = "<2", python = "=3.8"},
    {version = "^2.2.0", python = ">=3.9"}
]
xarray = [
    {version = "^2023.01.0", python = "=3.8"},
    {version = "2024.3.0", python = ">=3.9"}
]
#rioxarray = {version = "^0.14.1", python = ">=3.9,<4.0"}
#scipy = "^1.9"
#h5netcdf = "^1.0"
#netcdf4 = "^1.6"
#zarr = "^2.15.0"
#bottleneck = "^1.3.7"

jinja2 = "^3.1.2"
rtoml = {version = "^0.9.0", markers = "sys_platform != 'emscripten'"}
numpy = "1.26.4"
mercantile = "^1.2.1"

[tool.poetry.group.dev.dependencies]
# Set black to exact pin because it uses calendar versioning
# Note that this should match the version in .pre-commit-config.yaml
black = {version = "23.7.0", extras = ["jupyter"]}
isort = "^5.12.0"
ipykernel = "^6.22.0"
# https://github.com/ipython/ipython/issues/14051
ipython = "^8.7.0,<8.12.1"
mypy = "^1"
types-requests = "^2.29.0.0"
pytest = "^7.3.1"
pre-commit = "^3.3.1"
pytest-httpserver = "^1.0.8"
coverage = "^7.3.1"

[tool.poetry.group.test.dependencies]
h3 = "4.0.0b3"
contextily = ">=1.3.0"

[tool.poetry.scripts]
fused = 'fused.cli:main'

[tool.poetry-dynamic-versioning]
enable = false
vcs = "git"
# This makes strings like `1.3.2.dev3+28c1684` instead of `1.3.1.post3.dev0+28c1684`
bump = true

[tool.poetry-dynamic-versioning.substitution]
folders = [
    { path = "fused" }
]

[build-system]
requires = ["poetry-core>=1.0.0", "poetry-dynamic-versioning"]
build-backend = "poetry_dynamic_versioning.backend"


[tool.isort]
profile = "black"


[tool.ruff]
ignore = [
    "E501", # Line length
]
target-version = "py38"

[tool.mypy]
plugins = "pydantic.mypy"

[tool.coverage.run]
omit = [
    "tests/*",
]
