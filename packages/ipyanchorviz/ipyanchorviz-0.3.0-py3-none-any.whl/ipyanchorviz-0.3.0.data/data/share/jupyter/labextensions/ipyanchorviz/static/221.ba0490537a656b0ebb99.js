(self.webpackChunkipyanchorviz=self.webpackChunkipyanchorviz||[]).push([[221],{221:(t,n,e)=>{"use strict";e.r(n),e.d(n,{lasso:()=>d});var r=e(797),o=e(996),a=e(15),i=e(429);function s(t){return function(){return t}}function u(t,n,e,r,o,a,i,s,u,c){this.target=t,this.type=n,this.subject=e,this.identifier=r,this.active=o,this.x=a,this.y=i,this.dx=s,this.dy=u,this._=c}function c(){return!r.f0.ctrlKey&&!r.f0.button}function f(){return this.parentNode}function l(t){return null==t?{x:r.f0.x,y:r.f0.y}:t}function h(){return navigator.maxTouchPoints||"ontouchstart"in this}u.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var v=e(778),p=e.n(v);function d(){var t,n=[],e=75,v=!0,d=!1,g=!0,_={start:function(){},draw:function(){},end:function(){}};function y(y){var b,m,M,w,x=y.append("g").attr("class","lasso"),A=x.append("path").attr("class","drawn"),k=x.append("path").attr("class","loop_close"),E=x.append("circle").attr("class","origin"),S=function(){var t,n,e,v,p=c,d=f,g=l,_=h,y={},b=(0,o.A)("start","drag","end"),m=0,M=0;function w(t){t.on("mousedown.drag",x).filter(_).on("touchstart.drag",E).on("touchmove.drag",S).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function x(){if(!v&&p.apply(this,arguments)){var o=T("mouse",d.apply(this,arguments),r.gr,this,arguments);o&&((0,r.Lt)(r.f0.view).on("mousemove.drag",A,!0).on("mouseup.drag",k,!0),(0,a.A)(r.f0.view),(0,i.G)(),e=!1,t=r.f0.clientX,n=r.f0.clientY,o("start"))}}function A(){if((0,i.A)(),!e){var o=r.f0.clientX-t,a=r.f0.clientY-n;e=o*o+a*a>M}y.mouse("drag")}function k(){(0,r.Lt)(r.f0.view).on("mousemove.drag mouseup.drag",null),(0,a.y)(r.f0.view,e),(0,i.A)(),y.mouse("end")}function E(){if(p.apply(this,arguments)){var t,n,e=r.f0.changedTouches,o=d.apply(this,arguments),a=e.length;for(t=0;t<a;++t)(n=T(e[t].identifier,o,r._M,this,arguments))&&((0,i.G)(),n("start"))}}function S(){var t,n,e=r.f0.changedTouches,o=e.length;for(t=0;t<o;++t)(n=y[e[t].identifier])&&((0,i.A)(),n("drag"))}function P(){var t,n,e=r.f0.changedTouches,o=e.length;for(v&&clearTimeout(v),v=setTimeout((function(){v=null}),500),t=0;t<o;++t)(n=y[e[t].identifier])&&((0,i.G)(),n("end"))}function T(t,n,e,o,a){var i,s,c,f=e(n,t),l=b.copy();if((0,r.ex)(new u(w,"beforestart",i,t,m,f[0],f[1],0,0,l),(function(){return null!=(r.f0.subject=i=g.apply(o,a))&&(s=i.x-f[0]||0,c=i.y-f[1]||0,!0)})))return function h(v){var p,d=f;switch(v){case"start":y[t]=h,p=m++;break;case"end":delete y[t],--m;case"drag":f=e(n,t),p=m}(0,r.ex)(new u(w,v,i,t,p,f[0]+s,f[1]+c,f[0]-d[0],f[1]-d[1],l),l.apply,l,[v,o,a])}}return w.filter=function(t){return arguments.length?(p="function"==typeof t?t:s(!!t),w):p},w.container=function(t){return arguments.length?(d="function"==typeof t?t:s(t),w):d},w.subject=function(t){return arguments.length?(g="function"==typeof t?t:s(t),w):g},w.touchable=function(t){return arguments.length?(_="function"==typeof t?t:s(!!t),w):_},w.on=function(){var t=b.on.apply(b,arguments);return t===b?w:t},w.clickDistance=function(t){return arguments.length?(M=(t=+t)*t,w):Math.sqrt(M)},w}().on("start",(function(){w=[],b="",A.attr("d",null),k.attr("d",null),n.nodes().forEach((function(t){t.__lasso.possible=!1,t.__lasso.selected=!1,t.__lasso.hoverSelect=!1,t.__lasso.loopSelect=!1;var n=t.getBoundingClientRect();t.__lasso.lassoPoint=[Math.round(n.left+n.width/2),Math.round(n.top+n.height/2)]})),g&&n.on("mouseover.lasso",(function(){this.__lasso.hoverSelect=!0})),_.start()})).on("drag",(function(){var t,o;"touchmove"===r.f0.sourceEvent.type?(t=r.f0.sourceEvent.touches[0].clientX,o=r.f0.sourceEvent.touches[0].clientY):(t=r.f0.sourceEvent.clientX,o=r.f0.sourceEvent.clientY);var a=r.gr(this)[0],i=r.gr(this)[1];""===b?(b=b+"M "+a+" "+i,m=[t,o],M=[a,i],E.attr("cx",a).attr("cy",i).attr("r",7).attr("display",null)):b=b+" L "+a+" "+i,w.push([t,o]);var s=Math.sqrt(Math.pow(t-m[0],2)+Math.pow(o-m[1],2)),u="M "+a+" "+i+" L "+M[0]+" "+M[1];A.attr("d",b),k.attr("d",u),(d=s<=e)&&v?k.attr("display",null):k.attr("display","none"),n.nodes().forEach((function(t){t.__lasso.loopSelect=!(!d||!v)&&p()(w,t.__lasso.lassoPoint)<1,t.__lasso.possible=t.__lasso.hoverSelect||t.__lasso.loopSelect})),_.draw()})).on("end",(function(){n.on("mouseover.lasso",null),n.nodes().forEach((function(t){t.__lasso.selected=t.__lasso.possible,t.__lasso.possible=!1})),A.attr("d",null),k.attr("d",null),E.attr("display","none"),_.end()}));t.call(S)}return y.items=function(t){return arguments.length?((n=t).nodes().forEach((function(t){t.__lasso={possible:!1,selected:!1}})),y):n},y.possibleItems=function(){return n.filter((function(){return this.__lasso.possible}))},y.selectedItems=function(){return n.filter((function(){return this.__lasso.selected}))},y.notPossibleItems=function(){return n.filter((function(){return!this.__lasso.possible}))},y.notSelectedItems=function(){return n.filter((function(){return!this.__lasso.selected}))},y.closePathDistance=function(t){return arguments.length?(e=t,y):e},y.closePathSelect=function(t){return arguments.length?(v=!0===t,y):v},y.isPathClosed=function(t){return arguments.length?(d=!0===t,y):d},y.hoverSelect=function(t){return arguments.length?(g=!0===t,y):g},y.on=function(t,n){return arguments.length?1===arguments.length?_[t]:(["start","draw","end"].indexOf(t)>-1&&(_[t]=n),y):_},y.targetArea=function(n){return arguments.length?(t=n,y):t},y}},573:(t,n,e)=>{"use strict";var r=e(383),o=e(951),a=e(297),i=e(916);function s(t,n,e,r){return function(e,o,a){var i=t(t(n(o[1],a[0]),n(-a[1],o[0])),t(n(e[1],o[0]),n(-o[1],e[0]))),s=t(n(e[1],a[0]),n(-a[1],e[0])),u=r(i,s);return u[u.length-1]}}function u(t,n,e,r){return function(o,a,i,s){var u=t(t(e(t(n(i[1],s[0]),n(-s[1],i[0])),a[2]),t(e(t(n(a[1],s[0]),n(-s[1],a[0])),-i[2]),e(t(n(a[1],i[0]),n(-i[1],a[0])),s[2]))),t(e(t(n(a[1],s[0]),n(-s[1],a[0])),o[2]),t(e(t(n(o[1],s[0]),n(-s[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),s[2])))),c=t(t(e(t(n(i[1],s[0]),n(-s[1],i[0])),o[2]),t(e(t(n(o[1],s[0]),n(-s[1],o[0])),-i[2]),e(t(n(o[1],i[0]),n(-i[1],o[0])),s[2]))),t(e(t(n(a[1],i[0]),n(-i[1],a[0])),o[2]),t(e(t(n(o[1],i[0]),n(-i[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),i[2])))),f=r(u,c);return f[f.length-1]}}function c(t,n,e,r){return function(o,a,i,s,u){var c=t(t(t(e(t(e(t(n(s[1],u[0]),n(-u[1],s[0])),i[2]),t(e(t(n(i[1],u[0]),n(-u[1],i[0])),-s[2]),e(t(n(i[1],s[0]),n(-s[1],i[0])),u[2]))),a[3]),t(e(t(e(t(n(s[1],u[0]),n(-u[1],s[0])),a[2]),t(e(t(n(a[1],u[0]),n(-u[1],a[0])),-s[2]),e(t(n(a[1],s[0]),n(-s[1],a[0])),u[2]))),-i[3]),e(t(e(t(n(i[1],u[0]),n(-u[1],i[0])),a[2]),t(e(t(n(a[1],u[0]),n(-u[1],a[0])),-i[2]),e(t(n(a[1],i[0]),n(-i[1],a[0])),u[2]))),s[3]))),t(e(t(e(t(n(i[1],s[0]),n(-s[1],i[0])),a[2]),t(e(t(n(a[1],s[0]),n(-s[1],a[0])),-i[2]),e(t(n(a[1],i[0]),n(-i[1],a[0])),s[2]))),-u[3]),t(e(t(e(t(n(s[1],u[0]),n(-u[1],s[0])),a[2]),t(e(t(n(a[1],u[0]),n(-u[1],a[0])),-s[2]),e(t(n(a[1],s[0]),n(-s[1],a[0])),u[2]))),o[3]),e(t(e(t(n(s[1],u[0]),n(-u[1],s[0])),o[2]),t(e(t(n(o[1],u[0]),n(-u[1],o[0])),-s[2]),e(t(n(o[1],s[0]),n(-s[1],o[0])),u[2]))),-a[3])))),t(t(e(t(e(t(n(a[1],u[0]),n(-u[1],a[0])),o[2]),t(e(t(n(o[1],u[0]),n(-u[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),u[2]))),s[3]),t(e(t(e(t(n(a[1],s[0]),n(-s[1],a[0])),o[2]),t(e(t(n(o[1],s[0]),n(-s[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),s[2]))),-u[3]),e(t(e(t(n(i[1],s[0]),n(-s[1],i[0])),a[2]),t(e(t(n(a[1],s[0]),n(-s[1],a[0])),-i[2]),e(t(n(a[1],i[0]),n(-i[1],a[0])),s[2]))),o[3]))),t(e(t(e(t(n(i[1],s[0]),n(-s[1],i[0])),o[2]),t(e(t(n(o[1],s[0]),n(-s[1],o[0])),-i[2]),e(t(n(o[1],i[0]),n(-i[1],o[0])),s[2]))),-a[3]),t(e(t(e(t(n(a[1],s[0]),n(-s[1],a[0])),o[2]),t(e(t(n(o[1],s[0]),n(-s[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),s[2]))),i[3]),e(t(e(t(n(a[1],i[0]),n(-i[1],a[0])),o[2]),t(e(t(n(o[1],i[0]),n(-i[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),i[2]))),-s[3]))))),f=t(t(t(e(t(e(t(n(s[1],u[0]),n(-u[1],s[0])),i[2]),t(e(t(n(i[1],u[0]),n(-u[1],i[0])),-s[2]),e(t(n(i[1],s[0]),n(-s[1],i[0])),u[2]))),o[3]),e(t(e(t(n(s[1],u[0]),n(-u[1],s[0])),o[2]),t(e(t(n(o[1],u[0]),n(-u[1],o[0])),-s[2]),e(t(n(o[1],s[0]),n(-s[1],o[0])),u[2]))),-i[3])),t(e(t(e(t(n(i[1],u[0]),n(-u[1],i[0])),o[2]),t(e(t(n(o[1],u[0]),n(-u[1],o[0])),-i[2]),e(t(n(o[1],i[0]),n(-i[1],o[0])),u[2]))),s[3]),e(t(e(t(n(i[1],s[0]),n(-s[1],i[0])),o[2]),t(e(t(n(o[1],s[0]),n(-s[1],o[0])),-i[2]),e(t(n(o[1],i[0]),n(-i[1],o[0])),s[2]))),-u[3]))),t(t(e(t(e(t(n(i[1],u[0]),n(-u[1],i[0])),a[2]),t(e(t(n(a[1],u[0]),n(-u[1],a[0])),-i[2]),e(t(n(a[1],i[0]),n(-i[1],a[0])),u[2]))),o[3]),e(t(e(t(n(i[1],u[0]),n(-u[1],i[0])),o[2]),t(e(t(n(o[1],u[0]),n(-u[1],o[0])),-i[2]),e(t(n(o[1],i[0]),n(-i[1],o[0])),u[2]))),-a[3])),t(e(t(e(t(n(a[1],u[0]),n(-u[1],a[0])),o[2]),t(e(t(n(o[1],u[0]),n(-u[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),u[2]))),i[3]),e(t(e(t(n(a[1],i[0]),n(-i[1],a[0])),o[2]),t(e(t(n(o[1],i[0]),n(-i[1],o[0])),-a[2]),e(t(n(o[1],a[0]),n(-a[1],o[0])),i[2]))),-u[3])))),l=r(c,f);return l[l.length-1]}}function f(t){return(3===t?s:4===t?u:c)(o,r,a,i)}var l=f(3),h=f(4),v=[function(){return 0},function(){return 0},function(t,n){return n[0]-t[0]},function(t,n,e){var r,o=(t[1]-e[1])*(n[0]-e[0]),a=(t[0]-e[0])*(n[1]-e[1]),i=o-a;if(o>0){if(a<=0)return i;r=o+a}else{if(!(o<0))return i;if(a>=0)return i;r=-(o+a)}var s=33306690738754716e-32*r;return i>=s||i<=-s?i:l(t,n,e)},function(t,n,e,r){var o=t[0]-r[0],a=n[0]-r[0],i=e[0]-r[0],s=t[1]-r[1],u=n[1]-r[1],c=e[1]-r[1],f=t[2]-r[2],l=n[2]-r[2],v=e[2]-r[2],p=a*c,d=i*u,g=i*s,_=o*c,y=o*u,b=a*s,m=f*(p-d)+l*(g-_)+v*(y-b),M=7771561172376103e-31*((Math.abs(p)+Math.abs(d))*Math.abs(f)+(Math.abs(g)+Math.abs(_))*Math.abs(l)+(Math.abs(y)+Math.abs(b))*Math.abs(v));return m>M||-m>M?m:h(t,n,e,r)}];function p(t){var n=v[t.length];return n||(n=v[t.length]=f(t.length)),n.apply(void 0,t)}function d(t,n,e,r,o,a,i){return function(n,e,s,u,c){switch(arguments.length){case 0:case 1:return 0;case 2:return r(n,e);case 3:return o(n,e,s);case 4:return a(n,e,s,u);case 5:return i(n,e,s,u,c)}for(var f=new Array(arguments.length),l=0;l<arguments.length;++l)f[l]=arguments[l];return t(f)}}!function(){for(;v.length<=5;)v.push(f(v.length));t.exports=d.apply(void 0,[p].concat(v));for(var n=0;n<=5;++n)t.exports[n]=v[n]}()},778:(t,n,e)=>{t.exports=function(t,n){for(var e=n[0],o=n[1],a=t.length,i=1,s=a,u=0,c=a-1;u<s;c=u++){var f=t[u],l=t[c],h=f[1],v=l[1];if(v<h){if(v<o&&o<h){if(0===(p=r(f,l,n)))return 0;i^=0<p|0}else if(o===h&&h<t[(u+1)%a][1]){if(0===(p=r(f,l,n)))return 0;i^=0<p|0}}else if(h<v){if(h<o&&o<v){if(0===(p=r(f,l,n)))return 0;i^=p<0|0}else if(o===h&&t[(u+1)%a][1]<h){var p;if(0===(p=r(f,l,n)))return 0;i^=p<0|0}}else if(o===h){var d=Math.min(f[0],l[0]),g=Math.max(f[0],l[0]);if(0===u){for(;c>0;){var _=(c+a-1)%a;if((m=t[_])[1]!==o)break;var y=m[0];d=Math.min(d,y),g=Math.max(g,y),c=_}if(0===c)return d<=e&&e<=g?0:1;s=c+1}for(var b=t[(c+a-1)%a][1];u+1<s;){var m;if((m=t[u+1])[1]!==o)break;y=m[0],d=Math.min(d,y),g=Math.max(g,y),u+=1}if(d<=e&&e<=g)return 0;var M=t[(u+1)%a][1];e<d&&b<o!=M<o&&(i^=1)}}return 2*i-1};var r=e(573)},297:(t,n,e)=>{"use strict";var r=e(383),o=e(519);t.exports=function(t,n){var e=t.length;if(1===e){var a=r(t[0],n);return a[0]?a:[a[1]]}var i=new Array(2*e),s=[.1,.1],u=[.1,.1],c=0;r(t[0],n,s),s[0]&&(i[c++]=s[0]);for(var f=1;f<e;++f){r(t[f],n,u);var l=s[1];o(l,u[0],s),s[0]&&(i[c++]=s[0]);var h=u[1],v=s[1],p=h+v,d=v-(p-h);s[1]=p,d&&(i[c++]=d)}return s[1]&&(i[c++]=s[1]),0===c&&(i[c++]=0),i.length=c,i}},916:t=>{"use strict";t.exports=function(t,n){var e=0|t.length,r=0|n.length;if(1===e&&1===r)return function(t,n){var e=t+n,r=e-t,o=t-(e-r)+(n-r);return o?[o,e]:[e]}(t[0],-n[0]);var o,a,i=new Array(e+r),s=0,u=0,c=0,f=Math.abs,l=t[u],h=f(l),v=-n[c],p=f(v);h<p?(a=l,(u+=1)<e&&(h=f(l=t[u]))):(a=v,(c+=1)<r&&(p=f(v=-n[c]))),u<e&&h<p||c>=r?(o=l,(u+=1)<e&&(h=f(l=t[u]))):(o=v,(c+=1)<r&&(p=f(v=-n[c])));for(var d,g,_=o+a,y=_-o,b=a-y,m=b,M=_;u<e&&c<r;)h<p?(o=l,(u+=1)<e&&(h=f(l=t[u]))):(o=v,(c+=1)<r&&(p=f(v=-n[c]))),(b=(a=m)-(y=(_=o+a)-o))&&(i[s++]=b),m=M-((d=M+_)-(g=d-M))+(_-g),M=d;for(;u<e;)(b=(a=m)-(y=(_=(o=l)+a)-o))&&(i[s++]=b),m=M-((d=M+_)-(g=d-M))+(_-g),M=d,(u+=1)<e&&(l=t[u]);for(;c<r;)(b=(a=m)-(y=(_=(o=v)+a)-o))&&(i[s++]=b),m=M-((d=M+_)-(g=d-M))+(_-g),M=d,(c+=1)<r&&(v=-n[c]);return m&&(i[s++]=m),M&&(i[s++]=M),s||(i[s++]=0),i.length=s,i}},951:t=>{"use strict";t.exports=function(t,n){var e=0|t.length,r=0|n.length;if(1===e&&1===r)return function(t,n){var e=t+n,r=e-t,o=t-(e-r)+(n-r);return o?[o,e]:[e]}(t[0],n[0]);var o,a,i=new Array(e+r),s=0,u=0,c=0,f=Math.abs,l=t[u],h=f(l),v=n[c],p=f(v);h<p?(a=l,(u+=1)<e&&(h=f(l=t[u]))):(a=v,(c+=1)<r&&(p=f(v=n[c]))),u<e&&h<p||c>=r?(o=l,(u+=1)<e&&(h=f(l=t[u]))):(o=v,(c+=1)<r&&(p=f(v=n[c])));for(var d,g,_=o+a,y=_-o,b=a-y,m=b,M=_;u<e&&c<r;)h<p?(o=l,(u+=1)<e&&(h=f(l=t[u]))):(o=v,(c+=1)<r&&(p=f(v=n[c]))),(b=(a=m)-(y=(_=o+a)-o))&&(i[s++]=b),m=M-((d=M+_)-(g=d-M))+(_-g),M=d;for(;u<e;)(b=(a=m)-(y=(_=(o=l)+a)-o))&&(i[s++]=b),m=M-((d=M+_)-(g=d-M))+(_-g),M=d,(u+=1)<e&&(l=t[u]);for(;c<r;)(b=(a=m)-(y=(_=(o=v)+a)-o))&&(i[s++]=b),m=M-((d=M+_)-(g=d-M))+(_-g),M=d,(c+=1)<r&&(v=n[c]);return m&&(i[s++]=m),M&&(i[s++]=M),s||(i[s++]=0),i.length=s,i}},383:t=>{"use strict";t.exports=function(t,e,r){var o=t*e,a=n*t,i=a-(a-t),s=t-i,u=n*e,c=u-(u-e),f=e-c,l=s*f-(o-i*c-s*c-i*f);return r?(r[0]=l,r[1]=o,r):[l,o]};var n=+(Math.pow(2,27)+1)},519:t=>{"use strict";t.exports=function(t,n,e){var r=t+n,o=r-t,a=n-o,i=t-(r-o);return e?(e[0]=i+a,e[1]=r,e):[i+a,r]}}}]);