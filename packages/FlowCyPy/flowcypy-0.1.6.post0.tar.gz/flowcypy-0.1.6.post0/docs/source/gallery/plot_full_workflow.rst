
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/plot_full_workflow.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_plot_full_workflow.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_plot_full_workflow.py:


Simulating and Analyzing Flow Cytometer Signals
===============================================

This script demonstrates how to simulate flow cytometer signals using the `FlowCytometer` class
and analyze the results using the `PulseAnalyzer` class from the `FlowCyPy` library.

Flow cytometers measure forward scatter (FSC) and side scatter (SSC) signals when particles pass through a laser beam,
providing information about particle size, complexity, and other characteristics.

Steps in this Workflow:
-----------------------
1. Define a particle size distribution using `ScattererDistribution`.
2. Simulate flow cytometer signals using `FlowCytometer`.
3. Analyze the forward scatter signal with `PulseAnalyzer` to extract features like peak height, width, and area.
4. Visualize the generated signals and display the extracted pulse features.

.. GENERATED FROM PYTHON SOURCE LINES 18-89



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /gallery/images/sphx_glr_plot_full_workflow_001.png
         :alt: Detector: first detector, Size Distribution of Scatterers (Lognormal Distribution)
         :srcset: /gallery/images/sphx_glr_plot_full_workflow_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /gallery/images/sphx_glr_plot_full_workflow_002.png
         :alt: Pulse Analysis
         :srcset: /gallery/images/sphx_glr_plot_full_workflow_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Scatterers Properties
    +-------------------------------+--------------------+
    | Property                      | Value              |
    +===============================+====================+
    | Particle Density              | 10.00 Mparticle/m³ |
    +-------------------------------+--------------------+
    | Mean size                     | 10.00 µm           |
    +-------------------------------+--------------------+
    | Size standard deviation       | 800.00 nm          |
    +-------------------------------+--------------------+
    | Size coupling power mechanism | rayleigh           |
    +-------------------------------+--------------------+

    FlowCytometer Properties
    +----------------------------+------------+
    | Property                   | Value      |
    +============================+============+
    | Flow Speed                 | 80.00 µm/s |
    +----------------------------+------------+
    | Total Simulation Time      | 500.00 ms  |
    +----------------------------+------------+
    | Random Seed                | Not set    |
    +----------------------------+------------+
    | Estimated Number of Events | 400        |
    +----------------------------+------------+

    Source Properties
    +---------------+-------------+
    | Property      | Value       |
    +===============+=============+
    | Optical Power | 200.00 mW   |
    +---------------+-------------+
    | Wavelength    | 1.55×10⁰ µm |
    +---------------+-------------+

    Detector [first detector] Properties
    +-------------------------------+-------------+
    | Property                      | Value       |
    +===============================+=============+
    | Acquisition Frequency         | 10.00 kHz   |
    +-------------------------------+-------------+
    | Noise Level                   | 0.0 volt    |
    +-------------------------------+-------------+
    | Baseline Shift Amplitude      | 0.0 volt    |
    +-------------------------------+-------------+
    | Saturation Level              | 1000.0 volt |
    +-------------------------------+-------------+
    | Number of Discretization Bins | 1024        |
    +-------------------------------+-------------+

    Number of detected peaks: 9
    +--------+-------------+--------------+-------------+----------------+
    |   Peak | Time [s]    | Height       | Width       | Area           |
    +========+=============+==============+=============+================+
    |      1 | 7.17×10¹ ms | 1.78×10⁻¹ qV | 2.20×10² ms | 0.00×10⁰ s·V   |
    +--------+-------------+--------------+-------------+----------------+
    |      2 | 1.18×10² ms | 1.70×10⁻¹ qV | 2.10×10¹ ms | 3.50×10⁻³ qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      3 | 1.47×10² ms | 1.78×10⁻¹ qV | 6.67×10¹ ms | 1.09×10⁻² qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      4 | 2.06×10² ms | 1.46×10⁻¹ qV | 8.30×10⁰ ms | 1.19×10⁻³ qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      5 | 2.42×10² ms | 1.64×10⁻¹ qV | 1.93×10¹ ms | 3.01×10⁻³ qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      6 | 3.08×10² ms | 1.45×10⁻¹ qV | 1.88×10¹ ms | 2.59×10⁻³ qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      7 | 3.60×10² ms | 1.56×10⁻¹ qV | 6.79×10¹ ms | 9.22×10⁻³ qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      8 | 4.34×10² ms | 1.20×10⁻¹ qV | 4.80×10⁰ ms | 5.76×10⁻⁴ qV·s |
    +--------+-------------+--------------+-------------+----------------+
    |      9 | 4.67×10² ms | 1.32×10⁻¹ qV | 3.61×10¹ ms | 4.64×10⁻³ qV·s |
    +--------+-------------+--------------+-------------+----------------+

    '\nSummary:\n--------\nThis script simulates flow cytometer signals, processes them to detect peaks in the forward scatter channel,\nand extracts important features. The process is visualized through signal plots, and key properties are displayed.\n'





|

.. code-block:: python3


    # Step 1: Import necessary modules from FlowCyPy
    from FlowCyPy import FlowCytometer, ScattererDistribution, PulseAnalyzer, Detector, Source

    # Step 2: Define the particle size distribution
    # ---------------------------------------------
    # Using a lognormal size distribution with a mean of 10 µm and a standard deviation of 0.8 µm.
    scatterer_distribution = ScattererDistribution(
        particle_density=10e6,         # 10 million particles per cubic meter
        mean_size=10e-6,               # Mean particle size: 10 µm
        std_size=8e-7,                 # Standard deviation: 0.8 µm
        distribution_type='lognormal'  # Lognormal distribution
    )

    source = Source(
        wavelength=1550e-9,    # Wavelenght of the laser source: 1550 nm
        optical_power=200e-3,  # Optical power of the laser source: 200 milliwatt
    )

    detector = Detector(
        name='first detector',
        acquisition_frequency=1e4,  # Sampling frequency: 10,000 Hz
        noise_level=0.00,           # Signal noise level: 0.5 volts
        baseline_shift=0.00,        # Signal noise level: 0.5 volts
        saturation_level=1e3,       # Signal saturation at 1000 volts
        n_bins=1024                 # Discretization bins: 1024
    )

    # Step 3: Simulate Flow Cytometer Signals
    # ---------------------------------------
    # Create a FlowCytometer instance to simulate FSC/SSC signals with defined parameters.
    cytometer = FlowCytometer(
        source=source,
        flow_speed=80e-6,                # Flow speed: 80 µm/s
        flow_area=1,                     # Flow area: 1 m²
        total_time=0.5,                  # Simulation time: 0.5 seconds
        scatterer_distribution=scatterer_distribution,  # Using the defined particle size distribution
        detectors=[detector]             # Detectors to add to the system
    )

    # Generate simulated pulses for the FSC and SSC channels
    cytometer.simulate_pulse()

    # Display the properties of the simulated cytometer
    cytometer.print_properties()

    # Visualize the generated signals
    cytometer.plot()

    # Step 4: Analyze the Simulated FSC Signal
    # ----------------------------------------
    # Create a PulseAnalyzer to extract features like peak height, width, and area from the FSC signal.
    analyzer = PulseAnalyzer(
        detector=detector,        # Time detector to analyze the signal from
        height_threshold=None     # Threshold for detecting peaks
    )

    # # Run the analysis to detect and measure pulse features
    analyzer.run()

    analyzer.plot()

    # # Display the extracted peak features such as height, width, and area
    analyzer.display_features()

    """
    Summary:
    --------
    This script simulates flow cytometer signals, processes them to detect peaks in the forward scatter channel,
    and extracts important features. The process is visualized through signal plots, and key properties are displayed.
    """


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.427 seconds)


.. _sphx_glr_download_gallery_plot_full_workflow.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_full_workflow.py <plot_full_workflow.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_full_workflow.ipynb <plot_full_workflow.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
